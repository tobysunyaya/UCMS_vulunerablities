# UCMS v1.6.0 authentication bypass vulnerability 
* Vulnerability Type :  
cookies poisoning

* Recurring environment:  
macOS 12.3.1   
PHP 7.4.21
Apache 2.4.39

* Vulnerability Description AND recurrence:  
UCMS 1.6 suffers from an authentication bypass vulnerability. An unauthenticated attacker through cookie poisoning can remotely bypass authentication. For example, get super administrator privileges.
This Vulnerability is very easy to recurrence:

Fisrtly, login in the CMS as an general account, in this case, I use `toby`.
![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/1.jpg)  

You can see that there is a cookie named `admin_cb3c8c` and value is the current account.
![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/2.jpg)  

Secondly, change the cookie's value to `admin` and refresh. 

![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/3.jpg)  


You will find that more menu which can only be accessed by administrators appear.
![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/4.jpg)  

Thirdly, to test the administrator permission, you can add new users through the current account and observe the results.
![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/5.jpg)

The result shows that the cookies poisoning in this CMS can be exploited to bypass vulnerability.
![image](https://raw.githubusercontent.com/tobysunyaya/UCMS_vulunerablities/main/6.jpg)
